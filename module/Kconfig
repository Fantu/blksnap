# SPDX-License-Identifier: GPL-2.0
#
# blk-snap block io layer filter module configuration
#
#
#select BLK_FILTER

config BLK_SNAP
	tristate "Block device snapshot filter"
	depends on BLK_FILTER
	help

	  Allow to create snapshots and track block changes for a block
	  devices. Designed for creating backups for any block devices
	  (without device mapper). Snapshots are temporary and are released
	  then backup is completed. Change block tracking allows you to
	  create incremental or differential backups.

config BLK_SNAP_TRACKING_BLOCK_MINIMUM_SHIFT
	depends on BLK_SNAP
	int "The power of 2 for minimum trackings block size"
	default 16
	help
	  The minimum tracking block size by default is 64 KB (shift 16)
	  It's looks good for block device 128 GB or lower.
	  In this case, the block device is divided into 2097152 blocks.

config BLK_SNAP_TRACKING_BLOCK_MAXIMUM_COUNT
	depends on BLK_SNAP
	int "The limit of the maximum number of trackings blocks"
	default 2097152
	help
	  As the size of the block device grows, the size of the tracking block
	  size should also grow. For this purpose, the limit of the maximum
	  number of block size is set.

config BLK_SNAP_CHUNK_MINIMUM_SHIFT
	depends on BLK_SNAP
	int "The power of 2 for minimum snapshots chunk size"
	default 18
	help
	  The minimum chunk size by default is 256 KB (shift 18)
	  It's looks good for block device 128 GB or lower.
	  In this case, the block device is divided into 524288 chunks.

config BLK_SNAP_CHUNK_MAXIMUM_COUNT
	depends on BLK_SNAP
	int "The limit of the maximum number of snapshots chunks"
	default 2097152
	help
	  As the size of the block device grows, the size of the chunk
	  should also grow. For this purpose, the limit of the maximum number
	  of chunks is set.

config BLK_SNAP_CHUNK_MAXIMUM_IN_CACHE
	depends on BLK_SNAP
	int "The limit of the maximum chunks in memory cache"
	default 128
	help
	  Since reading and writing to snapshots is performed in large chunks,
	  a cache is implemented to optimize reading small portions of data
	  from the snapshot image. As the number of chunks in the cache
	  increases, memory consumption also increases.
	  The minimum recommended value is four.

config BLK_SNAP_DIFF_STORAGE_MINIMUM
	depends on BLK_SNAP
	int "The minimum allowable size of the difference storage in sectors"
	default 2097152
	help 
	  When reached, an event is generated about the lack of free space.
